package com.atguigu.ext;

import com.atguigu.bean.Blue;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.ComponentScan;
import org.springframework.context.annotation.Configuration;

/**
 * ??????
 * BeanPostProcessor??bean???????????bean???????????????????????????
 * 
 * 1??BeanFactoryPostProcessor??beanFactory????????????
 * 		??BeanFactory?????????????????????????BeanFactory???????
 * 		???§Ö?bean???????????????beanFactory??????bean???????¦Ä????
 * 
 * 
 * BeanFactoryPostProcessor???:
 * 1)??ioc????????????
 * 2)??invokeBeanFactoryPostProcessors(beanFactory);
 * 		?????????§Ö?BeanFactoryPostProcessor???????????????
 * 			1?????????BeanFactory???????????????BeanFactoryPostProcessor????????????????????
 * 			2???????????????????????????
 * 
 * 2??BeanDefinitionRegistryPostProcessor extends BeanFactoryPostProcessor
 * 		postProcessBeanDefinitionRegistry();
 * 		??????bean?????????????????bean?????¦Ä???????
 * 
 * 		??????BeanFactoryPostProcessor??§µ?
 * 		????BeanDefinitionRegistryPostProcessor?????????????????§»?????
 * 
 * 	???
 * 		1????ioc????????
 * 		2????refresh()-??invokeBeanFactoryPostProcessors(beanFactory);
 * 		3???????????§Ý???????§Ö?BeanDefinitionRegistryPostProcessor?????
 * 			1?????¦Ä??????§Ö?postProcessBeanDefinitionRegistry()????
 * 			2??????????postProcessBeanFactory()????BeanFactoryPostProcessor??
 * 
 * 		4???????????????????BeanFactoryPostProcessor???????????¦Ä???postProcessBeanFactory()????
 * 	
 * 3??ApplicationListener???????????§Ù?????????????????????????
 * 	  public interface ApplicationListener<E extends ApplicationEvent>
 * 		???? ApplicationEvent ????????????????
 * 
 * 	 ???Ñs
 * 		1????§Õ???????????ApplicationListener???????????????????ApplicationEvent????????
 * 			@EventListener;
 * 			??????EventListenerMethodProcessor???????????????????@EventListener??
 * 
 * 		2?????????????????????
 * 		3???????????????????????????????????????????????
 * 				ContextRefreshedEvent?????????????????bean???????????????????????
 * 				ContextClosedEvent?????????????????????
 * 		4????????????????
 * 				applicationContext.publishEvent()??
 * 	
 *  ???
 *  	ContextRefreshedEvent??IOCTest_Ext$1[source=??????????]??ContextClosedEvent??
 *  1????ContextRefreshedEvent?????
 *  	1????????????????refresh()??
 *  	2????finishRefresh();?????????????ContextRefreshedEvent???
 *  2????????????????
 *  3??????????????ContextClosedEvent??
 *  
 *  ????????????????
 *  	3????publishEvent(new ContextRefreshedEvent(this));
 *  			1??????????????????????????getApplicationEventMulticaster()
 *  			2????multicastEvent????????
 *  			3????????????§Ö?ApplicationListener??
 *  				for (final ApplicationListener<?> listener : getApplicationListeners(event, type)) {
 *  				1?????????Executor????????????Executor???????????
 *  					Executor executor = getTaskExecutor();
 *  				2?????????????????????listener??????invokeListener(listener, event);
 *  				 ???listener???onApplicationEvent??????
 *  
 *  ????????????????????
 *  	1????????????????refresh();
 *  	2????initApplicationEventMulticaster();?????ApplicationEventMulticaster??
 *  		1????????????????????id=??applicationEventMulticaster?????????
 *  		2??????????this.applicationEventMulticaster = new SimpleApplicationEventMulticaster(beanFactory);
 *  			????????????§µ????????????????????????????????????applicationEventMulticaster??
 *  
 *  ????????????§»????????
 *  	1????????????????refresh();
 *  	2????registerListeners();
 *  		??????????????§Ö?????????????????applicationEventMulticaster?§µ?
 *  		String[] listenerBeanNames = getBeanNamesForType(ApplicationListener.class, true, false);
 *  		//??listener???ApplicationEventMulticaster??
 *  		getApplicationEventMulticaster().addApplicationListenerBean(listenerBeanName);
 *  		
 *   SmartInitializingSingleton ???->afterSingletonsInstantiated();
 *   		1????ioc????????????refresh()??
 *   		2????finishBeanFactoryInitialization(beanFactory);?????????????bean??
 *   			1????????????§Ö?????bean??getBean();
 *   			2??????????§Õ??????????bean???§Ø??????SmartInitializingSingleton??????
 *   				?????????afterSingletonsInstantiated();
 * 		
 * 
 *
 */
@ComponentScan("com.atguigu.ext")
@Configuration
public class ExtConfig {
	
	@Bean
	public Blue blue(){
		return new Blue();
	}

}
